From a7f0d9432e85f8ae707f423617c916afbfbd45a3 Mon Sep 17 00:00:00 2001
From: ShajTester <andrey-shaj@ya.ru>
Date: Fri, 25 Jun 2021 13:26:01 +0300
Subject: [PATCH] Correct Gateway position

---
 ethernet_interface.cpp | 29 +++++++++++++++--------------
 1 file changed, 15 insertions(+), 14 deletions(-)

diff --git a/ethernet_interface.cpp b/ethernet_interface.cpp
index 82716f9..a9f6cc6 100644
--- a/ethernet_interface.cpp
+++ b/ethernet_interface.cpp
@@ -922,6 +922,21 @@ void EthernetInterface::writeConfigurationFile()
 
     bool dhcpv6Requested = dhcpToBeEnabled(IP::Protocol::IPv6, mappedDHCPState);
     bool dhcpv4Requested = dhcpToBeEnabled(IP::Protocol::IPv4, mappedDHCPState);
+
+    if (manager.getSystemConf())
+    {
+        const auto& gateway = manager.getSystemConf()->defaultGateway();
+        if (!gateway.empty())
+        {
+            stream << "Gateway=" << gateway << "\n";
+        }
+        const auto& gateway6 = manager.getSystemConf()->defaultGateway6();
+        if (!gateway6.empty())
+        {
+            stream << "Gateway=" << gateway6 << "\n";
+        }
+    }
+
     // Static IP addresses
     for (const auto& addr : addrs)
     {
@@ -942,20 +957,6 @@ void EthernetInterface::writeConfigurationFile()
         }
     }
 
-    if (manager.getSystemConf())
-    {
-        const auto& gateway = manager.getSystemConf()->defaultGateway();
-        if (!gateway.empty())
-        {
-            stream << "Gateway=" << gateway << "\n";
-        }
-        const auto& gateway6 = manager.getSystemConf()->defaultGateway6();
-        if (!gateway6.empty())
-        {
-            stream << "Gateway=" << gateway6 << "\n";
-        }
-    }
-
     // Write the neighbor sections
     for (const auto& neighbor : staticNeighbors)
     {
